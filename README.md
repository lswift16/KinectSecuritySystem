# Kinect Security System

The KinectSecuritySystem is a biometric system that allows users to unlock their doors with simple physical movements. By selecting from a set of pre-generated gestures the user can set a "lock" consisting of any three. To unlock a user simply has to preform these gestures, in their decided order, in front of the Kinect. The system then connects to an arduino via xBees which allows a user to take control of a MeArm robot via moving their right wrist up/down/left/right.

This project was built by:

-Joshua Starkey

-Luke Swift

-Beau Stanton

-Tom Wild

## Setup & Usage

### Equipment Required

1x Computer(Requires: Intel Chipset, USB-3)

1x Kinect 2

1x Arduino Uno

1x MeArm Robot

2x xBee Wireless Connectors

1x Breadboard

### Setup

1. Connect Kinect to computer and arduino to a power source and the MeArm robot

MeArm servo diagram:
![](http://i.imgur.com/BBcRBLy.jpg)

2. Connect 1 xBee to the computer and 1 xBee to the Arduino
3. Run the code
4. Choose a lock for the system via the lock builder GUI
5. Unlock the system by performing the gestures *you* set in the order *you* set them.
6. Move your right hand up/down/left/right to control the connected MeArm using the GUI to toggle rotational or arm motor control.

### Example Recordings

[Runtime Test: Screen Capture](https://www.youtube.com/watch?v=qxJ93gCaPPE)

[Runtime Test 2](https://www.youtube.com/watch?v=wPS7XSq4ES0)

## Project Functionality

### What Can KinectSecuritySystem Do?

#### Kinect Gesture Detection and Security
##### Build A Lock

Users can select a series of gestures from a pre-built .gbd database. Developers will be able to create their own .gbd file by using the Kinect Gesture Builder made by Microsoft (Link found in resources used section of the wiki). By selecting these gestures via a GUI interface they build a "lock" which forces anyone who wishes to open the door connected to the lock to perform said gestures in order.

The system for building a lock firstly assigns saved .gbd files (gestures generated via Visual Gesture Builder) to multiple variables. These gestures are then available for selection via drop-down lists on the GUI. A user upon going to the build lock tab is able to select the gestures they want for the lock via these lists.

##### Unlock Your Door

Users perform the chosen set of gestures and upon succeeding users gain access to the MeArm allowing them to control it. Upon failure an email is sent to the owner.

The system uses the above mentioned variables to compare the current skeleton wire-frames positions to that of the saved .gbd gesture database. Upon a succesful performance of the gestures in the correct order, the program switches UI tab and allows users to control the MeArm robot. Upon a failure, which constitutes performing a gesture at an incorrect point in the sequence 3 times, the C# program emails a "Security Alert" to a specific email address.

##### Security Alert Upon Failure

Upon failure a "Security Alert" is sent by the C# program to the owner of the system (currently set as programmingthings
gmail.com.

This is done by a simple smtp server built for/connected to gmail. A message is sent warning the recipient that failed attempts have been made to access their system with an additional date/time and screenshot of the Kinect's current view.

#### Arduino Support
##### MeArm Control (C# Side)

The C# program sends messages with degree (0 - 180) values attached to command the MeArm to move to that specific rotational or vertical point.

The program does this by converting the Kinect's -1 to 1 x/y positioning of a specific joint (in our case the right wrist) into a value between 0 - 180. The equation for this is as following: d = (f / 0.011) + 90 where d is the output degrees sent to the MeArm and f is the float generated by the Kinect. 0.011 is 2 (the difference between -1 & 1) divided by 180. The messages sent are only for 1 axis at a time due to limitations found with the MeArm. The axis can be toggled using a button on the UI to change whether x or y commands are sent.

##### MeArm Control (Arduino Side)

Rotational and arm servos are activated by the arduino to turn a specific amount of degrees which allow the MeArm to perform simple movements.

Upon receiving the applicable messages the arduino commands the MeArm to move to the set amount of degrees it has been told to. Currently the system only allows x or y movements at a time but the arduino code is able to handle both without any editing.

## Resources Used

### References, Tutorials & Examples

#### [Kinect Gesture Creation](https://channel9.msdn.com/Blogs/k4wdev/Custom-Gestures-End-to-End-with-Kinect-and-Visual-Gesture-Builder)

#### [Cake Robot Example](https://channel9.msdn.com/coding4fun/blog/Kinect--C--Arduino--Anoop--CakeRobot)

#### [Kinect Libraries](http://codigogenerativo.com/code/kinectpv2-k4w2-processing-library/)

#### [Hand-Tracker](https://github.com/OpenNI/OpenNI/blob/master/Samples/NiHandTracker/NiHandTracker.cpp)

#### [Gesture Detector Help](https://social.msdn.microsoft.com/Forums/en-US/239009cb-58cd-4556-b38b-831fd70ffe99/several-gestures-using-vgb-gesture-detector-on-code?forum=kinectv2sdk)

#### [Gesture Builder](http://kinect.github.io/tutorial/lab12/index.html)

#### [Angela Hillier: Continuous Gestures Example](https://github.com/angelaHillier/ContinuousGestureBasics-WPF)

#### [Angelia Hillier: Thread](https://social.msdn.microsoft.com/Forums/en-US/1562bb0b-dae0-4222-9b12-a4743085ccfa/training-using-visual-gesture-builder-to-learn-a-sequence-of-gesture?forum=kinectv2sdk)

#### [Robot Arm With Kinect Example](https://github.com/erolkaftanoglu/Robot-Arm-with-Kinect)

#### [Robot Arm Kinect Example 2](https://github.com/rwaldron/johnny-five/blob/master/docs/kinect-arm-controller.md)

#### [Fritzing](http://fritzing.org/home/)

### Software Used

#### Visual Studio

Used for building the C# program that connects to the Kinect and via xBees the Arduino.

#### Arduino Development Environment

Used for taking in messages from the C# program and via a connected breadboard, command a MeArm to turn servos in order to move to specific points.

#### Kinect Gesture Builder

This software allows the conversion of raw video footage (recorded via the Kinect 2) into gestures. This is done by importing video footage of a gesture being performed, and then giving each frame a mark of either TRUE (gesture is being performed), or FALSE (gesture isn't being performed). This is then processed using Kinect Gesture Builder to create a .gbd file that is used in our system.

#### Fritzing

Fritzing is an open-sourced piece of software that allows you to model the setup of various pieces of hardware. In this project we used it to model the layout of the Arduino, Breadboard and MeArm setup.
